<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Parentheses</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Parentheses.html" class="Module">Parentheses</a> <a id="20" class="Keyword">where</a>

<a id="27" class="Keyword">open</a> <a id="32" class="Keyword">import</a> <a id="39" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="49" class="Keyword">open</a> <a id="54" class="Keyword">import</a> <a id="61" href="Data.Maybe.html" class="Module">Data.Maybe</a>
<a id="72" class="Keyword">open</a> <a id="77" class="Keyword">import</a> <a id="84" href="Data.Char.html" class="Module">Data.Char</a>
<a id="94" class="Keyword">open</a> <a id="99" class="Keyword">import</a> <a id="106" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="121" class="Symbol">as</a> <a id="124" class="Module">List</a>
<a id="129" class="Keyword">import</a> <a id="136" href="Data.List.Sized.Interface.html" class="Module">Data.List.Sized.Interface</a>
<a id="162" class="Keyword">open</a> <a id="167" class="Keyword">import</a> <a id="174" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="184" class="Keyword">open</a> <a id="189" class="Keyword">import</a> <a id="196" href="Relation.Nullary.html" class="Module">Relation.Nullary</a>
<a id="213" class="Keyword">open</a> <a id="218" class="Keyword">import</a> <a id="225" href="Relation.Binary.html" class="Module">Relation.Binary</a>

<a id="242" class="Keyword">open</a> <a id="247" class="Keyword">import</a> <a id="254" href="Agda.Builtin.Equality.html" class="Module">Agda.Builtin.Equality</a>
<a id="276" class="Keyword">open</a> <a id="281" class="Keyword">import</a> <a id="288" href="Function.html" class="Module">Function</a>

<a id="298" class="Keyword">open</a> <a id="303" class="Keyword">import</a> <a id="310" href="Base.html" class="Module">Base</a>

<a id="316" class="Comment">-- Well-parenthesised string</a>
<a id="345" class="Keyword">data</a> <a id="PAR"></a><a id="350" href="Parentheses.html#350" class="Datatype">PAR</a> <a id="354" class="Symbol">:</a> <a id="356" class="PrimitiveType">Set</a> <a id="360" class="Keyword">where</a>
  <a id="PAR.LPAR"></a><a id="368" href="Parentheses.html#368" class="InductiveConstructor">LPAR</a> <a id="PAR.RPAR"></a><a id="373" href="Parentheses.html#373" class="InductiveConstructor">RPAR</a> <a id="378" class="Symbol">:</a> <a id="380" href="Parentheses.html#350" class="Datatype">PAR</a>
  <a id="PAR.LCUR"></a><a id="386" href="Parentheses.html#386" class="InductiveConstructor">LCUR</a> <a id="PAR.RCUR"></a><a id="391" href="Parentheses.html#391" class="InductiveConstructor">RCUR</a> <a id="396" class="Symbol">:</a> <a id="398" href="Parentheses.html#350" class="Datatype">PAR</a>
  <a id="PAR.LSQU"></a><a id="404" href="Parentheses.html#404" class="InductiveConstructor">LSQU</a> <a id="PAR.RSQU"></a><a id="409" href="Parentheses.html#409" class="InductiveConstructor">RSQU</a> <a id="414" class="Symbol">:</a> <a id="416" href="Parentheses.html#350" class="Datatype">PAR</a>

<a id="eqPAR"></a><a id="421" href="Parentheses.html#421" class="Function">eqPAR</a> <a id="427" class="Symbol">:</a> <a id="429" href="Relation.Binary.Definitions.html#4575" class="Function">Decidable</a> <a id="439" class="Symbol">{</a><a id="440" class="Argument">A</a> <a id="442" class="Symbol">=</a> <a id="444" href="Parentheses.html#350" class="Datatype">PAR</a><a id="447" class="Symbol">}</a> <a id="449" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">_≡_</a>
<a id="453" href="Parentheses.html#421" class="Function">eqPAR</a> <a id="459" href="Parentheses.html#368" class="InductiveConstructor">LPAR</a> <a id="464" href="Parentheses.html#368" class="InductiveConstructor">LPAR</a> <a id="469" class="Symbol">=</a> <a id="471" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a> <a id="475" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
<a id="480" href="Parentheses.html#421" class="Function">eqPAR</a> <a id="486" href="Parentheses.html#373" class="InductiveConstructor">RPAR</a> <a id="491" href="Parentheses.html#373" class="InductiveConstructor">RPAR</a> <a id="496" class="Symbol">=</a> <a id="498" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a> <a id="502" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
<a id="507" href="Parentheses.html#421" class="Function">eqPAR</a> <a id="513" href="Parentheses.html#386" class="InductiveConstructor">LCUR</a> <a id="518" href="Parentheses.html#386" class="InductiveConstructor">LCUR</a> <a id="523" class="Symbol">=</a> <a id="525" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a> <a id="529" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
<a id="534" href="Parentheses.html#421" class="Function">eqPAR</a> <a id="540" href="Parentheses.html#391" class="InductiveConstructor">RCUR</a> <a id="545" href="Parentheses.html#391" class="InductiveConstructor">RCUR</a> <a id="550" class="Symbol">=</a> <a id="552" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a> <a id="556" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
<a id="561" href="Parentheses.html#421" class="Function">eqPAR</a> <a id="567" href="Parentheses.html#404" class="InductiveConstructor">LSQU</a> <a id="572" href="Parentheses.html#404" class="InductiveConstructor">LSQU</a> <a id="577" class="Symbol">=</a> <a id="579" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a> <a id="583" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
<a id="588" href="Parentheses.html#421" class="Function">eqPAR</a> <a id="594" href="Parentheses.html#409" class="InductiveConstructor">RSQU</a> <a id="599" href="Parentheses.html#409" class="InductiveConstructor">RSQU</a> <a id="604" class="Symbol">=</a> <a id="606" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a> <a id="610" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
<a id="615" class="Comment">-- catchall for no</a>
<a id="634" href="Parentheses.html#421" class="CatchallClause Function">eqPAR</a><a id="639" class="CatchallClause"> </a><a id="640" class="CatchallClause Symbol">_</a><a id="641" class="CatchallClause"> </a><a id="642" class="CatchallClause Symbol">_</a> <a id="644" class="Symbol">=</a> <a id="646" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="649" href="Parentheses.html#676" class="Postulate">whatever</a> <a id="658" class="Keyword">where</a>
  <a id="666" class="Keyword">postulate</a> <a id="676" href="Parentheses.html#676" class="Postulate">whatever</a> <a id="685" class="Symbol">:</a> <a id="687" class="Symbol">{</a><a id="688" href="Parentheses.html#688" class="Bound">A</a> <a id="690" class="Symbol">:</a> <a id="692" class="PrimitiveType">Set</a><a id="695" class="Symbol">}</a> <a id="697" class="Symbol">→</a> <a id="699" href="Parentheses.html#688" class="Bound">A</a>


<a id="703" class="Keyword">instance</a>
  <a id="714" href="Parentheses.html#714" class="Function">_</a> <a id="716" class="Symbol">:</a> <a id="718" href="Relation.Binary.PropositionalEquality.Decidable.Core.html#195" class="Record">DecidableEquality</a> <a id="736" href="Parentheses.html#350" class="Datatype">PAR</a>
  <a id="742" class="Symbol">_</a> <a id="744" class="Symbol">=</a> <a id="746" class="Keyword">record</a> <a id="753" class="Symbol">{</a> <a id="755" href="Relation.Binary.PropositionalEquality.Decidable.Core.html#251" class="Field">decide</a> <a id="762" class="Symbol">=</a> <a id="764" href="Parentheses.html#421" class="Function">eqPAR</a> <a id="770" class="Symbol">}</a>

  <a id="tokPAR"></a><a id="775" href="Parentheses.html#775" class="Function">tokPAR</a> <a id="782" class="Symbol">:</a> <a id="784" href="Base.html#1258" class="Record">Tokenizer</a> <a id="794" href="Parentheses.html#350" class="Datatype">PAR</a>
  <a id="800" href="Parentheses.html#775" class="Function">tokPAR</a> <a id="807" class="Symbol">=</a> <a id="809" href="Base.html#1304" class="InductiveConstructor">mkTokenizer</a> <a id="821" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="823" href="Data.List.Base.html#3511" class="Function">List.foldr</a> <a id="834" class="Symbol">(</a><a id="835" href="Data.List.Base.html#1649" class="Function Operator">_++_</a> <a id="840" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="842" href="Parentheses.html#863" class="Function">toPAR</a><a id="847" class="Symbol">)</a> <a id="849" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a> <a id="852" class="Keyword">where</a>

    <a id="863" href="Parentheses.html#863" class="Function">toPAR</a> <a id="869" class="Symbol">:</a> <a id="871" href="Agda.Builtin.Char.html#200" class="Postulate">Char</a> <a id="876" class="Symbol">→</a> <a id="878" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="883" href="Parentheses.html#350" class="Datatype">PAR</a>
    <a id="891" href="Parentheses.html#863" class="Function">toPAR</a> <a id="897" href="Parentheses.html#897" class="Bound">c</a> <a id="899" class="Symbol">=</a> <a id="901" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="904" href="Parentheses.html#897" class="Bound">c</a> <a id="906" href="Data.Char.Properties.html#2504" class="Function Operator">==</a> <a id="909" class="String">&#39;(&#39;</a> <a id="913" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="918" href="Parentheses.html#368" class="InductiveConstructor">LPAR</a> <a id="923" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="925" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>
         <a id="937" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="942" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="945" href="Parentheses.html#897" class="Bound">c</a> <a id="947" href="Data.Char.Properties.html#2504" class="Function Operator">==</a> <a id="950" class="String">&#39;)&#39;</a> <a id="954" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="959" href="Parentheses.html#373" class="InductiveConstructor">RPAR</a> <a id="964" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="966" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>
         <a id="978" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="983" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="986" href="Parentheses.html#897" class="Bound">c</a> <a id="988" href="Data.Char.Properties.html#2504" class="Function Operator">==</a> <a id="991" class="String">&#39;{&#39;</a> <a id="995" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="1000" href="Parentheses.html#386" class="InductiveConstructor">LCUR</a> <a id="1005" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1007" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>
         <a id="1019" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="1024" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="1027" href="Parentheses.html#897" class="Bound">c</a> <a id="1029" href="Data.Char.Properties.html#2504" class="Function Operator">==</a> <a id="1032" class="String">&#39;}&#39;</a> <a id="1036" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="1041" href="Parentheses.html#391" class="InductiveConstructor">RCUR</a> <a id="1046" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1048" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>
         <a id="1060" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="1065" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="1068" href="Parentheses.html#897" class="Bound">c</a> <a id="1070" href="Data.Char.Properties.html#2504" class="Function Operator">==</a> <a id="1073" class="String">&#39;[&#39;</a> <a id="1077" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="1082" href="Parentheses.html#404" class="InductiveConstructor">LSQU</a> <a id="1087" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1089" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>
         <a id="1101" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="1106" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="1109" href="Parentheses.html#897" class="Bound">c</a> <a id="1111" href="Data.Char.Properties.html#2504" class="Function Operator">==</a> <a id="1114" class="String">&#39;]&#39;</a> <a id="1118" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="1123" href="Parentheses.html#409" class="InductiveConstructor">RSQU</a> <a id="1128" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1130" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>
         <a id="1142" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="1147" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a> <a id="1150" class="Comment">-- ignoring other characters as noise</a>


<a id="Pars"></a><a id="1190" href="Parentheses.html#1190" class="Function">Pars</a> <a id="1195" class="Symbol">:</a> <a id="1197" href="Text.Parser.Types.html#306" class="Record">Parameters</a>
<a id="1208" href="Parentheses.html#1190" class="Function">Pars</a> <a id="1213" class="Symbol">=</a> <a id="1215" href="Text.Parser.Monad.html#4373" class="Function">vec</a> <a id="1219" href="Parentheses.html#350" class="Datatype">PAR</a>

<a id="PAR′"></a><a id="1224" href="Parentheses.html#1224" class="Function">PAR′</a> <a id="1229" class="Symbol">:</a> <a id="1231" href="Relation.Unary.html#3297" class="Function">∀[</a> <a id="1234" href="Text.Parser.Types.html#1195" class="Record">Parser</a> <a id="1241" href="Parentheses.html#1190" class="Function">Pars</a> <a id="1246" href="Agda.Builtin.Unit.html#137" class="Record">⊤</a> <a id="1248" href="Relation.Unary.html#3297" class="Function">]</a>
<a id="1250" href="Parentheses.html#1224" class="Function">PAR′</a> <a id="1255" class="Symbol">=</a> <a id="1257" href="Induction.Nat.Strong.html#1160" class="Function">fix</a> <a id="1261" class="Symbol">(</a><a id="1262" href="Text.Parser.Types.html#1195" class="Record">Parser</a> <a id="1269" href="Parentheses.html#1190" class="Function">Pars</a> <a id="1274" href="Agda.Builtin.Unit.html#137" class="Record">⊤</a><a id="1275" class="Symbol">)</a> <a id="1277" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="1279" class="Symbol">λ</a> <a id="1281" href="Parentheses.html#1281" class="Bound">rec</a> <a id="1285" class="Symbol">→</a>
   <a id="1290" class="Keyword">let</a> <a id="1294" href="Parentheses.html#1294" class="Bound Operator">_R?_R?</a> <a id="1301" class="Symbol">:</a> <a id="1303" href="Parentheses.html#350" class="Datatype">PAR</a> <a id="1307" class="Symbol">→</a> <a id="1309" href="Parentheses.html#350" class="Datatype">PAR</a> <a id="1313" class="Symbol">→</a> <a id="1315" href="Text.Parser.Types.html#1195" class="Record">Parser</a> <a id="1322" href="Parentheses.html#1190" class="Function">Pars</a> <a id="1327" href="Agda.Builtin.Unit.html#137" class="Record">⊤</a> <a id="1329" class="Symbol">_</a>
       <a id="1338" href="Parentheses.html#1294" class="Bound Operator">_R?_R?</a> <a id="1345" href="Parentheses.html#1345" class="Bound">p</a> <a id="1347" href="Parentheses.html#1347" class="Bound">q</a> <a id="1349" class="Symbol">=</a> <a id="1351" href="Agda.Builtin.Unit.html#174" class="InductiveConstructor">tt</a> <a id="1354" href="Text.Parser.Combinators.html#2471" class="Function Operator">&lt;$</a> <a id="1357" class="Symbol">((</a><a id="1359" href="Text.Parser.Combinators.html#6166" class="Function">exact</a> <a id="1365" href="Parentheses.html#1345" class="Bound">p</a> <a id="1367" href="Text.Parser.Combinators.html#4654" class="Function Operator">&lt;&amp;?&gt;</a> <a id="1372" href="Parentheses.html#1281" class="Bound">rec</a><a id="1375" class="Symbol">)</a> <a id="1377" href="Text.Parser.Combinators.html#3634" class="Function Operator">&lt;&amp;</a> <a id="1380" href="Text.Parser.Combinators.html#2036" class="Function">box</a> <a id="1384" class="Symbol">(</a><a id="1385" href="Text.Parser.Combinators.html#6166" class="Function">exact</a> <a id="1391" href="Parentheses.html#1347" class="Bound">q</a> <a id="1393" href="Text.Parser.Combinators.html#4654" class="Function Operator">&lt;&amp;?&gt;</a> <a id="1398" href="Parentheses.html#1281" class="Bound">rec</a><a id="1401" class="Symbol">))</a>
   <a id="1407" class="Keyword">in</a>    <a id="1413" href="Parentheses.html#368" class="InductiveConstructor">LPAR</a> <a id="1418" href="Parentheses.html#1294" class="Bound Operator">R?</a> <a id="1421" href="Parentheses.html#373" class="InductiveConstructor">RPAR</a> <a id="1426" href="Parentheses.html#1294" class="Bound Operator">R?</a>
     <a id="1434" href="Text.Parser.Combinators.html#2170" class="Function Operator">&lt;|&gt;</a> <a id="1438" href="Parentheses.html#386" class="InductiveConstructor">LCUR</a> <a id="1443" href="Parentheses.html#1294" class="Bound Operator">R?</a> <a id="1446" href="Parentheses.html#391" class="InductiveConstructor">RCUR</a> <a id="1451" href="Parentheses.html#1294" class="Bound Operator">R?</a>
     <a id="1459" href="Text.Parser.Combinators.html#2170" class="Function Operator">&lt;|&gt;</a> <a id="1463" href="Parentheses.html#404" class="InductiveConstructor">LSQU</a> <a id="1468" href="Parentheses.html#1294" class="Bound Operator">R?</a> <a id="1471" href="Parentheses.html#409" class="InductiveConstructor">RSQU</a> <a id="1476" href="Parentheses.html#1294" class="Bound Operator">R?</a>

<a id="1480" class="Comment">-- tests</a>

<a id="1490" href="Parentheses.html#1490" class="Function">_</a> <a id="1492" class="Symbol">:</a> <a id="1494" class="String">&quot;hel[{(lo({((wor))ld})wan)t}som{e()[n]o}i(s)e]?&quot;</a> <a id="1543" href="Base.html#2716" class="Function Operator">∈</a> <a id="1545" href="Parentheses.html#1224" class="Function">PAR′</a>
<a id="1550" class="Symbol">_</a> <a id="1552" class="Symbol">=</a> <a id="1554" class="Symbol">_</a> <a id="1556" href="Base.html#1223" class="InductiveConstructor Operator">!</a>
</pre></body></html>