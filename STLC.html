<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>STLC</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="STLC.html" class="Module">STLC</a> <a id="13" class="Keyword">where</a>

<a id="20" class="Keyword">open</a> <a id="25" class="Keyword">import</a> <a id="32" href="Level.html" class="Module">Level</a>
<a id="38" class="Keyword">open</a> <a id="43" class="Keyword">import</a> <a id="50" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="60" class="Keyword">open</a> <a id="65" class="Keyword">import</a> <a id="72" href="Data.Empty.html" class="Module">Data.Empty</a>
<a id="83" class="Keyword">open</a> <a id="88" class="Keyword">import</a> <a id="95" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a>
<a id="110" class="Keyword">open</a> <a id="115" class="Keyword">import</a> <a id="122" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="142" class="Keyword">using</a> <a id="148" class="Symbol">(</a><a id="149" href="Data.Nat.Properties.html#3725" class="Function">≤-refl</a><a id="155" class="Symbol">)</a>
<a id="157" class="Keyword">open</a> <a id="162" class="Keyword">import</a> <a id="169" href="Data.Char.Base.html" class="Module">Data.Char.Base</a>
<a id="184" class="Keyword">open</a> <a id="189" class="Keyword">import</a> <a id="196" href="Data.String.html" class="Module">Data.String</a> <a id="208" class="Symbol">as</a> <a id="211" class="Module">String</a> <a id="218" class="Keyword">hiding</a> <a id="225" class="Symbol">(</a><a id="226" href="Data.String.Base.html#2567" class="Function">parens</a><a id="232" class="Symbol">)</a>
<a id="234" class="Keyword">open</a> <a id="239" class="Keyword">import</a> <a id="246" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="261" class="Symbol">as</a> <a id="264" class="Module">List</a>
<a id="269" class="Keyword">open</a> <a id="274" class="Keyword">import</a> <a id="281" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a>
<a id="300" class="Keyword">open</a> <a id="305" class="Keyword">import</a> <a id="312" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="321" class="Symbol">as</a> <a id="324" class="Module">Vec</a>
<a id="328" class="Keyword">open</a> <a id="333" class="Keyword">import</a> <a id="340" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a>
<a id="356" class="Keyword">open</a> <a id="361" class="Keyword">import</a> <a id="368" href="Data.List.Sized.Interface.html" class="Module">Data.List.Sized.Interface</a>
<a id="394" class="Keyword">open</a> <a id="399" class="Keyword">import</a> <a id="406" href="Data.Product.html" class="Module">Data.Product</a>
<a id="419" class="Keyword">open</a> <a id="424" class="Keyword">import</a> <a id="431" href="Induction.Nat.Strong.html" class="Module">Induction.Nat.Strong</a> <a id="452" class="Symbol">as</a> <a id="455" class="Module">INS</a> <a id="459" class="Keyword">using</a> <a id="465" class="Symbol">(</a><a id="466" href="Induction.Nat.Strong.html#197" class="Record Operator">□_</a><a id="468" class="Symbol">;</a> <a id="470" href="Induction.Nat.Strong.html#1160" class="Function">fix</a><a id="473" class="Symbol">)</a>
<a id="475" class="Keyword">open</a> <a id="480" class="Keyword">import</a> <a id="487" href="Function.html" class="Module">Function</a>

<a id="497" class="Keyword">open</a> <a id="502" class="Keyword">import</a> <a id="509" href="Relation.Nullary.html" class="Module">Relation.Nullary</a>
<a id="526" class="Keyword">open</a> <a id="531" class="Keyword">import</a> <a id="538" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="565" class="Keyword">using</a> <a id="571" class="Symbol">(</a><a id="572" href="Relation.Nullary.Decidable.Core.html#3636" class="Function">map′</a><a id="576" class="Symbol">)</a>
<a id="578" class="Keyword">open</a> <a id="583" class="Keyword">import</a> <a id="590" href="Relation.Unary.html" class="Module">Relation.Unary</a> <a id="605" class="Symbol">as</a> <a id="608" class="Module">U</a> <a id="610" class="Keyword">renaming</a> <a id="619" class="Symbol">(</a><a id="620" href="Relation.Unary.html#4338" class="Function Operator">_⇒_</a> <a id="624" class="Symbol">to</a> <a id="Unary._⇒_"></a><a id="627" href="STLC.html#627" class="Function Operator">_⟶_</a><a id="630" class="Symbol">)</a>
<a id="632" class="Keyword">open</a> <a id="637" class="Keyword">import</a> <a id="644" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="660" class="Symbol">as</a> <a id="663" class="Module">B</a> <a id="665" class="Keyword">hiding</a> <a id="672" class="Symbol">(</a><a id="673" href="Relation.Binary.Definitions.html#4883" class="Function">DecidableEquality</a><a id="690" class="Symbol">)</a>
<a id="692" class="Keyword">open</a> <a id="697" class="Keyword">import</a> <a id="704" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>

<a id="743" class="Keyword">open</a> <a id="748" class="Keyword">import</a> <a id="755" href="Text.Parser.Types.html" class="Module">Text.Parser.Types</a>
<a id="773" class="Keyword">open</a> <a id="778" class="Keyword">import</a> <a id="785" href="Text.Parser.Position.html" class="Module">Text.Parser.Position</a>
<a id="806" class="Keyword">open</a> <a id="811" class="Keyword">import</a> <a id="818" href="Text.Parser.Combinators.html" class="Module">Text.Parser.Combinators</a>
<a id="842" class="Keyword">open</a> <a id="847" class="Keyword">import</a> <a id="854" href="Text.Parser.Combinators.Numbers.html" class="Module">Text.Parser.Combinators.Numbers</a>
<a id="886" class="Keyword">open</a> <a id="891" class="Keyword">import</a> <a id="898" href="Text.Parser.Monad.html" class="Module">Text.Parser.Monad</a>

<a id="917" class="Keyword">data</a> <a id="Tok"></a><a id="922" href="STLC.html#922" class="Datatype">Tok</a> <a id="926" class="Symbol">:</a> <a id="928" class="PrimitiveType">Set</a> <a id="932" class="Keyword">where</a>
  <a id="Tok.LAM"></a><a id="940" href="STLC.html#940" class="InductiveConstructor">LAM</a> <a id="Tok.ARR"></a><a id="944" href="STLC.html#944" class="InductiveConstructor">ARR</a> <a id="Tok.DOT"></a><a id="948" href="STLC.html#948" class="InductiveConstructor">DOT</a> <a id="Tok.COL"></a><a id="952" href="STLC.html#952" class="InductiveConstructor">COL</a> <a id="956" class="Symbol">:</a> <a id="958" href="STLC.html#922" class="Datatype">Tok</a>
  <a id="Tok.LPAR"></a><a id="964" href="STLC.html#964" class="InductiveConstructor">LPAR</a> <a id="Tok.RPAR"></a><a id="969" href="STLC.html#969" class="InductiveConstructor">RPAR</a> <a id="974" class="Symbol">:</a> <a id="976" href="STLC.html#922" class="Datatype">Tok</a>
  <a id="Tok.ID"></a><a id="982" href="STLC.html#982" class="InductiveConstructor">ID</a> <a id="985" class="Symbol">:</a> <a id="987" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="994" class="Symbol">→</a> <a id="996" href="STLC.html#922" class="Datatype">Tok</a>

<a id="eqTok"></a><a id="1001" href="STLC.html#1001" class="Function">eqTok</a> <a id="1007" class="Symbol">:</a> <a id="1009" href="Relation.Binary.Definitions.html#4575" class="Function">B.Decidable</a> <a id="1021" class="Symbol">{</a><a id="1022" class="Argument">A</a> <a id="1024" class="Symbol">=</a> <a id="1026" href="STLC.html#922" class="Datatype">Tok</a><a id="1029" class="Symbol">}</a> <a id="1031" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a>
<a id="1035" href="STLC.html#1001" class="Function">eqTok</a> <a id="1041" href="STLC.html#940" class="InductiveConstructor">LAM</a> <a id="1045" href="STLC.html#940" class="InductiveConstructor">LAM</a> <a id="1049" class="Symbol">=</a> <a id="1051" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a> <a id="1055" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="1060" href="STLC.html#1001" class="Function">eqTok</a> <a id="1066" href="STLC.html#940" class="InductiveConstructor">LAM</a> <a id="1070" href="STLC.html#944" class="InductiveConstructor">ARR</a> <a id="1074" class="Symbol">=</a> <a id="1076" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="1079" class="Symbol">(λ</a> <a id="1082" class="Symbol">())</a>
<a id="1086" href="STLC.html#1001" class="Function">eqTok</a> <a id="1092" href="STLC.html#940" class="InductiveConstructor">LAM</a> <a id="1096" href="STLC.html#948" class="InductiveConstructor">DOT</a> <a id="1100" class="Symbol">=</a> <a id="1102" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="1105" class="Symbol">(λ</a> <a id="1108" class="Symbol">())</a>
<a id="1112" href="STLC.html#1001" class="Function">eqTok</a> <a id="1118" href="STLC.html#940" class="InductiveConstructor">LAM</a> <a id="1122" href="STLC.html#952" class="InductiveConstructor">COL</a> <a id="1126" class="Symbol">=</a> <a id="1128" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="1131" class="Symbol">(λ</a> <a id="1134" class="Symbol">())</a>
<a id="1138" href="STLC.html#1001" class="Function">eqTok</a> <a id="1144" href="STLC.html#940" class="InductiveConstructor">LAM</a> <a id="1148" href="STLC.html#964" class="InductiveConstructor">LPAR</a> <a id="1153" class="Symbol">=</a> <a id="1155" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="1158" class="Symbol">(λ</a> <a id="1161" class="Symbol">())</a>
<a id="1165" href="STLC.html#1001" class="Function">eqTok</a> <a id="1171" href="STLC.html#940" class="InductiveConstructor">LAM</a> <a id="1175" href="STLC.html#969" class="InductiveConstructor">RPAR</a> <a id="1180" class="Symbol">=</a> <a id="1182" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="1185" class="Symbol">(λ</a> <a id="1188" class="Symbol">())</a>
<a id="1192" href="STLC.html#1001" class="Function">eqTok</a> <a id="1198" href="STLC.html#940" class="InductiveConstructor">LAM</a> <a id="1202" class="Symbol">(</a><a id="1203" href="STLC.html#982" class="InductiveConstructor">ID</a> <a id="1206" href="STLC.html#1206" class="Bound">x</a><a id="1207" class="Symbol">)</a> <a id="1209" class="Symbol">=</a> <a id="1211" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="1214" class="Symbol">(λ</a> <a id="1217" class="Symbol">())</a>
<a id="1221" href="STLC.html#1001" class="Function">eqTok</a> <a id="1227" href="STLC.html#944" class="InductiveConstructor">ARR</a> <a id="1231" href="STLC.html#940" class="InductiveConstructor">LAM</a> <a id="1235" class="Symbol">=</a> <a id="1237" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="1240" class="Symbol">(λ</a> <a id="1243" class="Symbol">())</a>
<a id="1247" href="STLC.html#1001" class="Function">eqTok</a> <a id="1253" href="STLC.html#944" class="InductiveConstructor">ARR</a> <a id="1257" href="STLC.html#944" class="InductiveConstructor">ARR</a> <a id="1261" class="Symbol">=</a> <a id="1263" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a> <a id="1267" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="1272" href="STLC.html#1001" class="Function">eqTok</a> <a id="1278" href="STLC.html#944" class="InductiveConstructor">ARR</a> <a id="1282" href="STLC.html#948" class="InductiveConstructor">DOT</a> <a id="1286" class="Symbol">=</a> <a id="1288" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="1291" class="Symbol">(λ</a> <a id="1294" class="Symbol">())</a>
<a id="1298" href="STLC.html#1001" class="Function">eqTok</a> <a id="1304" href="STLC.html#944" class="InductiveConstructor">ARR</a> <a id="1308" href="STLC.html#952" class="InductiveConstructor">COL</a> <a id="1312" class="Symbol">=</a> <a id="1314" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="1317" class="Symbol">(λ</a> <a id="1320" class="Symbol">())</a>
<a id="1324" href="STLC.html#1001" class="Function">eqTok</a> <a id="1330" href="STLC.html#944" class="InductiveConstructor">ARR</a> <a id="1334" href="STLC.html#964" class="InductiveConstructor">LPAR</a> <a id="1339" class="Symbol">=</a> <a id="1341" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="1344" class="Symbol">(λ</a> <a id="1347" class="Symbol">())</a>
<a id="1351" href="STLC.html#1001" class="Function">eqTok</a> <a id="1357" href="STLC.html#944" class="InductiveConstructor">ARR</a> <a id="1361" href="STLC.html#969" class="InductiveConstructor">RPAR</a> <a id="1366" class="Symbol">=</a> <a id="1368" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="1371" class="Symbol">(λ</a> <a id="1374" class="Symbol">())</a>
<a id="1378" href="STLC.html#1001" class="Function">eqTok</a> <a id="1384" href="STLC.html#944" class="InductiveConstructor">ARR</a> <a id="1388" class="Symbol">(</a><a id="1389" href="STLC.html#982" class="InductiveConstructor">ID</a> <a id="1392" href="STLC.html#1392" class="Bound">x</a><a id="1393" class="Symbol">)</a> <a id="1395" class="Symbol">=</a> <a id="1397" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="1400" class="Symbol">(λ</a> <a id="1403" class="Symbol">())</a>
<a id="1407" href="STLC.html#1001" class="Function">eqTok</a> <a id="1413" href="STLC.html#948" class="InductiveConstructor">DOT</a> <a id="1417" href="STLC.html#940" class="InductiveConstructor">LAM</a> <a id="1421" class="Symbol">=</a> <a id="1423" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="1426" class="Symbol">(λ</a> <a id="1429" class="Symbol">())</a>
<a id="1433" href="STLC.html#1001" class="Function">eqTok</a> <a id="1439" href="STLC.html#948" class="InductiveConstructor">DOT</a> <a id="1443" href="STLC.html#944" class="InductiveConstructor">ARR</a> <a id="1447" class="Symbol">=</a> <a id="1449" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="1452" class="Symbol">(λ</a> <a id="1455" class="Symbol">())</a>
<a id="1459" href="STLC.html#1001" class="Function">eqTok</a> <a id="1465" href="STLC.html#948" class="InductiveConstructor">DOT</a> <a id="1469" href="STLC.html#948" class="InductiveConstructor">DOT</a> <a id="1473" class="Symbol">=</a> <a id="1475" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a> <a id="1479" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="1484" href="STLC.html#1001" class="Function">eqTok</a> <a id="1490" href="STLC.html#948" class="InductiveConstructor">DOT</a> <a id="1494" href="STLC.html#952" class="InductiveConstructor">COL</a> <a id="1498" class="Symbol">=</a> <a id="1500" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="1503" class="Symbol">(λ</a> <a id="1506" class="Symbol">())</a>
<a id="1510" href="STLC.html#1001" class="Function">eqTok</a> <a id="1516" href="STLC.html#948" class="InductiveConstructor">DOT</a> <a id="1520" href="STLC.html#964" class="InductiveConstructor">LPAR</a> <a id="1525" class="Symbol">=</a> <a id="1527" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="1530" class="Symbol">(λ</a> <a id="1533" class="Symbol">())</a>
<a id="1537" href="STLC.html#1001" class="Function">eqTok</a> <a id="1543" href="STLC.html#948" class="InductiveConstructor">DOT</a> <a id="1547" href="STLC.html#969" class="InductiveConstructor">RPAR</a> <a id="1552" class="Symbol">=</a> <a id="1554" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="1557" class="Symbol">(λ</a> <a id="1560" class="Symbol">())</a>
<a id="1564" href="STLC.html#1001" class="Function">eqTok</a> <a id="1570" href="STLC.html#948" class="InductiveConstructor">DOT</a> <a id="1574" class="Symbol">(</a><a id="1575" href="STLC.html#982" class="InductiveConstructor">ID</a> <a id="1578" href="STLC.html#1578" class="Bound">x</a><a id="1579" class="Symbol">)</a> <a id="1581" class="Symbol">=</a> <a id="1583" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="1586" class="Symbol">(λ</a> <a id="1589" class="Symbol">())</a>
<a id="1593" href="STLC.html#1001" class="Function">eqTok</a> <a id="1599" href="STLC.html#952" class="InductiveConstructor">COL</a> <a id="1603" href="STLC.html#940" class="InductiveConstructor">LAM</a> <a id="1607" class="Symbol">=</a> <a id="1609" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="1612" class="Symbol">(λ</a> <a id="1615" class="Symbol">())</a>
<a id="1619" href="STLC.html#1001" class="Function">eqTok</a> <a id="1625" href="STLC.html#952" class="InductiveConstructor">COL</a> <a id="1629" href="STLC.html#944" class="InductiveConstructor">ARR</a> <a id="1633" class="Symbol">=</a> <a id="1635" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="1638" class="Symbol">(λ</a> <a id="1641" class="Symbol">())</a>
<a id="1645" href="STLC.html#1001" class="Function">eqTok</a> <a id="1651" href="STLC.html#952" class="InductiveConstructor">COL</a> <a id="1655" href="STLC.html#948" class="InductiveConstructor">DOT</a> <a id="1659" class="Symbol">=</a> <a id="1661" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="1664" class="Symbol">(λ</a> <a id="1667" class="Symbol">())</a>
<a id="1671" href="STLC.html#1001" class="Function">eqTok</a> <a id="1677" href="STLC.html#952" class="InductiveConstructor">COL</a> <a id="1681" href="STLC.html#952" class="InductiveConstructor">COL</a> <a id="1685" class="Symbol">=</a> <a id="1687" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a> <a id="1691" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="1696" href="STLC.html#1001" class="Function">eqTok</a> <a id="1702" href="STLC.html#952" class="InductiveConstructor">COL</a> <a id="1706" href="STLC.html#964" class="InductiveConstructor">LPAR</a> <a id="1711" class="Symbol">=</a> <a id="1713" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="1716" class="Symbol">(λ</a> <a id="1719" class="Symbol">())</a>
<a id="1723" href="STLC.html#1001" class="Function">eqTok</a> <a id="1729" href="STLC.html#952" class="InductiveConstructor">COL</a> <a id="1733" href="STLC.html#969" class="InductiveConstructor">RPAR</a> <a id="1738" class="Symbol">=</a> <a id="1740" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="1743" class="Symbol">(λ</a> <a id="1746" class="Symbol">())</a>
<a id="1750" href="STLC.html#1001" class="Function">eqTok</a> <a id="1756" href="STLC.html#952" class="InductiveConstructor">COL</a> <a id="1760" class="Symbol">(</a><a id="1761" href="STLC.html#982" class="InductiveConstructor">ID</a> <a id="1764" href="STLC.html#1764" class="Bound">x</a><a id="1765" class="Symbol">)</a> <a id="1767" class="Symbol">=</a> <a id="1769" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="1772" class="Symbol">(λ</a> <a id="1775" class="Symbol">())</a>
<a id="1779" href="STLC.html#1001" class="Function">eqTok</a> <a id="1785" href="STLC.html#964" class="InductiveConstructor">LPAR</a> <a id="1790" href="STLC.html#940" class="InductiveConstructor">LAM</a> <a id="1794" class="Symbol">=</a> <a id="1796" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="1799" class="Symbol">(λ</a> <a id="1802" class="Symbol">())</a>
<a id="1806" href="STLC.html#1001" class="Function">eqTok</a> <a id="1812" href="STLC.html#964" class="InductiveConstructor">LPAR</a> <a id="1817" href="STLC.html#944" class="InductiveConstructor">ARR</a> <a id="1821" class="Symbol">=</a> <a id="1823" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="1826" class="Symbol">(λ</a> <a id="1829" class="Symbol">())</a>
<a id="1833" href="STLC.html#1001" class="Function">eqTok</a> <a id="1839" href="STLC.html#964" class="InductiveConstructor">LPAR</a> <a id="1844" href="STLC.html#948" class="InductiveConstructor">DOT</a> <a id="1848" class="Symbol">=</a> <a id="1850" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="1853" class="Symbol">(λ</a> <a id="1856" class="Symbol">())</a>
<a id="1860" href="STLC.html#1001" class="Function">eqTok</a> <a id="1866" href="STLC.html#964" class="InductiveConstructor">LPAR</a> <a id="1871" href="STLC.html#952" class="InductiveConstructor">COL</a> <a id="1875" class="Symbol">=</a> <a id="1877" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="1880" class="Symbol">(λ</a> <a id="1883" class="Symbol">())</a>
<a id="1887" href="STLC.html#1001" class="Function">eqTok</a> <a id="1893" href="STLC.html#964" class="InductiveConstructor">LPAR</a> <a id="1898" href="STLC.html#964" class="InductiveConstructor">LPAR</a> <a id="1903" class="Symbol">=</a> <a id="1905" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a> <a id="1909" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="1914" href="STLC.html#1001" class="Function">eqTok</a> <a id="1920" href="STLC.html#964" class="InductiveConstructor">LPAR</a> <a id="1925" href="STLC.html#969" class="InductiveConstructor">RPAR</a> <a id="1930" class="Symbol">=</a> <a id="1932" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="1935" class="Symbol">(λ</a> <a id="1938" class="Symbol">())</a>
<a id="1942" href="STLC.html#1001" class="Function">eqTok</a> <a id="1948" href="STLC.html#964" class="InductiveConstructor">LPAR</a> <a id="1953" class="Symbol">(</a><a id="1954" href="STLC.html#982" class="InductiveConstructor">ID</a> <a id="1957" href="STLC.html#1957" class="Bound">x</a><a id="1958" class="Symbol">)</a> <a id="1960" class="Symbol">=</a> <a id="1962" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="1965" class="Symbol">(λ</a> <a id="1968" class="Symbol">())</a>
<a id="1972" href="STLC.html#1001" class="Function">eqTok</a> <a id="1978" href="STLC.html#969" class="InductiveConstructor">RPAR</a> <a id="1983" href="STLC.html#940" class="InductiveConstructor">LAM</a> <a id="1987" class="Symbol">=</a> <a id="1989" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="1992" class="Symbol">(λ</a> <a id="1995" class="Symbol">())</a>
<a id="1999" href="STLC.html#1001" class="Function">eqTok</a> <a id="2005" href="STLC.html#969" class="InductiveConstructor">RPAR</a> <a id="2010" href="STLC.html#944" class="InductiveConstructor">ARR</a> <a id="2014" class="Symbol">=</a> <a id="2016" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="2019" class="Symbol">(λ</a> <a id="2022" class="Symbol">())</a>
<a id="2026" href="STLC.html#1001" class="Function">eqTok</a> <a id="2032" href="STLC.html#969" class="InductiveConstructor">RPAR</a> <a id="2037" href="STLC.html#948" class="InductiveConstructor">DOT</a> <a id="2041" class="Symbol">=</a> <a id="2043" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="2046" class="Symbol">(λ</a> <a id="2049" class="Symbol">())</a>
<a id="2053" href="STLC.html#1001" class="Function">eqTok</a> <a id="2059" href="STLC.html#969" class="InductiveConstructor">RPAR</a> <a id="2064" href="STLC.html#952" class="InductiveConstructor">COL</a> <a id="2068" class="Symbol">=</a> <a id="2070" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="2073" class="Symbol">(λ</a> <a id="2076" class="Symbol">())</a>
<a id="2080" href="STLC.html#1001" class="Function">eqTok</a> <a id="2086" href="STLC.html#969" class="InductiveConstructor">RPAR</a> <a id="2091" href="STLC.html#964" class="InductiveConstructor">LPAR</a> <a id="2096" class="Symbol">=</a> <a id="2098" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="2101" class="Symbol">(λ</a> <a id="2104" class="Symbol">())</a>
<a id="2108" href="STLC.html#1001" class="Function">eqTok</a> <a id="2114" href="STLC.html#969" class="InductiveConstructor">RPAR</a> <a id="2119" href="STLC.html#969" class="InductiveConstructor">RPAR</a> <a id="2124" class="Symbol">=</a> <a id="2126" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a> <a id="2130" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="2135" href="STLC.html#1001" class="Function">eqTok</a> <a id="2141" href="STLC.html#969" class="InductiveConstructor">RPAR</a> <a id="2146" class="Symbol">(</a><a id="2147" href="STLC.html#982" class="InductiveConstructor">ID</a> <a id="2150" href="STLC.html#2150" class="Bound">x</a><a id="2151" class="Symbol">)</a> <a id="2153" class="Symbol">=</a> <a id="2155" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="2158" class="Symbol">(λ</a> <a id="2161" class="Symbol">())</a>
<a id="2165" href="STLC.html#1001" class="Function">eqTok</a> <a id="2171" class="Symbol">(</a><a id="2172" href="STLC.html#982" class="InductiveConstructor">ID</a> <a id="2175" href="STLC.html#2175" class="Bound">x</a><a id="2176" class="Symbol">)</a> <a id="2178" href="STLC.html#940" class="InductiveConstructor">LAM</a> <a id="2182" class="Symbol">=</a> <a id="2184" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="2187" class="Symbol">(λ</a> <a id="2190" class="Symbol">())</a>
<a id="2194" href="STLC.html#1001" class="Function">eqTok</a> <a id="2200" class="Symbol">(</a><a id="2201" href="STLC.html#982" class="InductiveConstructor">ID</a> <a id="2204" href="STLC.html#2204" class="Bound">x</a><a id="2205" class="Symbol">)</a> <a id="2207" href="STLC.html#944" class="InductiveConstructor">ARR</a> <a id="2211" class="Symbol">=</a> <a id="2213" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="2216" class="Symbol">(λ</a> <a id="2219" class="Symbol">())</a>
<a id="2223" href="STLC.html#1001" class="Function">eqTok</a> <a id="2229" class="Symbol">(</a><a id="2230" href="STLC.html#982" class="InductiveConstructor">ID</a> <a id="2233" href="STLC.html#2233" class="Bound">x</a><a id="2234" class="Symbol">)</a> <a id="2236" href="STLC.html#948" class="InductiveConstructor">DOT</a> <a id="2240" class="Symbol">=</a> <a id="2242" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="2245" class="Symbol">(λ</a> <a id="2248" class="Symbol">())</a>
<a id="2252" href="STLC.html#1001" class="Function">eqTok</a> <a id="2258" class="Symbol">(</a><a id="2259" href="STLC.html#982" class="InductiveConstructor">ID</a> <a id="2262" href="STLC.html#2262" class="Bound">x</a><a id="2263" class="Symbol">)</a> <a id="2265" href="STLC.html#952" class="InductiveConstructor">COL</a> <a id="2269" class="Symbol">=</a> <a id="2271" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="2274" class="Symbol">(λ</a> <a id="2277" class="Symbol">())</a>
<a id="2281" href="STLC.html#1001" class="Function">eqTok</a> <a id="2287" class="Symbol">(</a><a id="2288" href="STLC.html#982" class="InductiveConstructor">ID</a> <a id="2291" href="STLC.html#2291" class="Bound">x</a><a id="2292" class="Symbol">)</a> <a id="2294" href="STLC.html#964" class="InductiveConstructor">LPAR</a> <a id="2299" class="Symbol">=</a> <a id="2301" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="2304" class="Symbol">(λ</a> <a id="2307" class="Symbol">())</a>
<a id="2311" href="STLC.html#1001" class="Function">eqTok</a> <a id="2317" class="Symbol">(</a><a id="2318" href="STLC.html#982" class="InductiveConstructor">ID</a> <a id="2321" href="STLC.html#2321" class="Bound">x</a><a id="2322" class="Symbol">)</a> <a id="2324" href="STLC.html#969" class="InductiveConstructor">RPAR</a> <a id="2329" class="Symbol">=</a> <a id="2331" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="2334" class="Symbol">(λ</a> <a id="2337" class="Symbol">())</a>
<a id="2341" href="STLC.html#1001" class="Function">eqTok</a> <a id="2347" class="Symbol">(</a><a id="2348" href="STLC.html#982" class="InductiveConstructor">ID</a> <a id="2351" href="STLC.html#2351" class="Bound">x</a><a id="2352" class="Symbol">)</a> <a id="2354" class="Symbol">(</a><a id="2355" href="STLC.html#982" class="InductiveConstructor">ID</a> <a id="2358" href="STLC.html#2358" class="Bound">y</a><a id="2359" class="Symbol">)</a> <a id="2361" class="Symbol">=</a> <a id="2363" href="Relation.Nullary.Decidable.Core.html#3636" class="Function">map′</a> <a id="2368" class="Symbol">(</a><a id="2369" href="Relation.Binary.PropositionalEquality.Core.html#1131" class="Function">cong</a> <a id="2374" href="STLC.html#982" class="InductiveConstructor">ID</a><a id="2376" class="Symbol">)</a> <a id="2378" class="Symbol">(λ</a> <a id="2381" class="Keyword">where</a> <a id="2387" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="2392" class="Symbol">→</a> <a id="2394" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="2398" class="Symbol">)</a> <a id="2400" class="Symbol">(</a><a id="2401" href="STLC.html#2351" class="Bound">x</a> <a id="2403" href="Data.String.Properties.html#2409" class="Function Operator">String.≟</a> <a id="2412" href="STLC.html#2358" class="Bound">y</a><a id="2413" class="Symbol">)</a>

<a id="Token"></a><a id="2416" href="STLC.html#2416" class="Function">Token</a> <a id="2422" class="Symbol">:</a> <a id="2424" class="PrimitiveType">Set</a>
<a id="2428" href="STLC.html#2416" class="Function">Token</a> <a id="2434" class="Symbol">=</a> <a id="2436" href="Text.Parser.Position.html#310" class="Record">Position</a> <a id="2445" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="2447" href="STLC.html#922" class="Datatype">Tok</a>

<a id="keywords"></a><a id="2452" href="STLC.html#2452" class="Function">keywords</a> <a id="2461" class="Symbol">:</a> <a id="2463" href="Data.List.NonEmpty.html#1318" class="Record">List⁺</a> <a id="2469" class="Symbol">(</a><a id="2470" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="2477" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="2479" href="STLC.html#922" class="Datatype">Tok</a><a id="2482" class="Symbol">)</a>
<a id="2484" href="STLC.html#2452" class="Function">keywords</a> <a id="2493" class="Symbol">=</a> <a id="2495" class="Symbol">(</a><a id="2496" class="String">&quot;→&quot;</a>   <a id="2502" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2504" href="STLC.html#944" class="InductiveConstructor">ARR</a><a id="2507" class="Symbol">)</a>
         <a id="2518" href="Data.List.NonEmpty.html#1364" class="InductiveConstructor Operator">∷</a> <a id="2520" class="Symbol">(</a><a id="2521" class="String">&quot;λ&quot;</a>   <a id="2527" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2529" href="STLC.html#940" class="InductiveConstructor">LAM</a><a id="2532" class="Symbol">)</a>
         <a id="2543" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2545" class="Symbol">(</a><a id="2546" class="String">&quot;:&quot;</a>   <a id="2552" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2554" href="STLC.html#952" class="InductiveConstructor">COL</a><a id="2557" class="Symbol">)</a>
         <a id="2568" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2570" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>

<a id="breaking"></a><a id="2574" href="STLC.html#2574" class="Function">breaking</a> <a id="2583" class="Symbol">:</a> <a id="2585" href="Agda.Builtin.Char.html#227" class="Postulate">Char</a> <a id="2590" class="Symbol">→</a> <a id="2592" href="Data.Product.html#1369" class="Function">∃</a> <a id="2594" class="Symbol">λ</a> <a id="2596" href="STLC.html#2596" class="Bound">b</a> <a id="2598" class="Symbol">→</a> <a id="2600" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="2603" href="STLC.html#2596" class="Bound">b</a> <a id="2605" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="2610" href="Data.Maybe.Base.html#838" class="Datatype">Maybe</a> <a id="2616" href="STLC.html#922" class="Datatype">Tok</a> <a id="2620" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="2625" href="Level.html#400" class="Record">Lift</a> <a id="2630" class="Symbol">_</a> <a id="2632" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
<a id="2634" href="STLC.html#2574" class="Function">breaking</a> <a id="2643" href="STLC.html#2643" class="Bound">c</a> <a id="2645" class="Symbol">=</a> <a id="2647" href="Function.Base.html#3544" class="Function Operator">case</a> <a id="2652" href="STLC.html#2643" class="Bound">c</a> <a id="2654" href="Function.Base.html#3544" class="Function Operator">of</a> <a id="2657" class="Symbol">λ</a> <a id="2659" class="Keyword">where</a>
  <a id="2667" class="String">&#39;(&#39;</a> <a id="2671" class="Symbol">→</a> <a id="2673" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a> <a id="2678" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2680" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a> <a id="2685" href="STLC.html#964" class="InductiveConstructor">LPAR</a>
  <a id="2692" class="String">&#39;)&#39;</a> <a id="2696" class="Symbol">→</a> <a id="2698" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a> <a id="2703" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2705" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a> <a id="2710" href="STLC.html#969" class="InductiveConstructor">RPAR</a>
  <a id="2717" class="String">&#39;.&#39;</a> <a id="2721" class="Symbol">→</a> <a id="2723" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a> <a id="2728" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2730" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a> <a id="2735" href="STLC.html#948" class="InductiveConstructor">DOT</a>
  <a id="2741" href="STLC.html#2741" class="Bound">c</a>   <a id="2745" class="Symbol">→</a> <a id="2747" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="2750" href="Data.Char.Base.html#758" class="Primitive">isSpace</a> <a id="2758" href="STLC.html#2741" class="Bound">c</a> <a id="2760" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="2765" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a> <a id="2770" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2772" href="Data.Maybe.Base.html#872" class="InductiveConstructor">nothing</a> <a id="2780" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="2785" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="2791" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2793" class="Symbol">_</a>

<a id="2796" class="Keyword">open</a> <a id="2801" class="Keyword">import</a> <a id="2808" href="Text.Lexer.html" class="Module">Text.Lexer</a> <a id="2819" href="STLC.html#2452" class="Function">keywords</a> <a id="2828" href="STLC.html#2574" class="Function">breaking</a> <a id="2837" href="STLC.html#982" class="InductiveConstructor">ID</a> <a id="2840" class="Keyword">using</a> <a id="2846" class="Symbol">(</a>tokenize<a id="2855" class="Symbol">)</a>

<a id="2858" class="Keyword">infixr</a> <a id="2865" class="Number">15</a> <a id="2868" href="STLC.html#2920" class="InductiveConstructor Operator">_`→_</a>
<a id="2873" class="Keyword">data</a> <a id="Type"></a><a id="2878" href="STLC.html#2878" class="Datatype">Type</a> <a id="2883" class="Symbol">:</a> <a id="2885" class="PrimitiveType">Set</a> <a id="2889" class="Keyword">where</a>
  <a id="Type.`κ"></a><a id="2897" href="STLC.html#2897" class="InductiveConstructor">`κ</a>   <a id="2902" class="Symbol">:</a> <a id="2904" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="2911" class="Symbol">→</a> <a id="2913" href="STLC.html#2878" class="Datatype">Type</a>
  <a id="Type._`→_"></a><a id="2920" href="STLC.html#2920" class="InductiveConstructor Operator">_`→_</a> <a id="2925" class="Symbol">:</a> <a id="2927" href="STLC.html#2878" class="Datatype">Type</a> <a id="2932" class="Symbol">→</a> <a id="2934" href="STLC.html#2878" class="Datatype">Type</a> <a id="2939" class="Symbol">→</a> <a id="2941" href="STLC.html#2878" class="Datatype">Type</a>

<a id="2947" class="Keyword">module</a> <a id="ParserM"></a><a id="2954" href="STLC.html#2954" class="Module">ParserM</a> <a id="2962" class="Symbol">=</a> <a id="2964" href="Text.Parser.Monad.html#3968" class="Module">Agdarsec</a> <a id="2973" href="Text.Parser.Position.html#310" class="Record">Position</a> <a id="2982" href="Data.Empty.html#526" class="Datatype">⊥</a> <a id="2984" class="Symbol">(</a><a id="2985" class="Keyword">record</a> <a id="2992" class="Symbol">{</a> <a id="2994" href="Data.Subset.html#109" class="Field">into</a> <a id="2999" class="Symbol">=</a> <a id="3001" href="Data.Product.html#666" class="Field">proj₁</a> <a id="3007" class="Symbol">})</a>
<a id="3010" class="Keyword">open</a> <a id="3015" href="STLC.html#2954" class="Module">ParserM</a>

<a id="3024" class="Keyword">instance</a>
  <a id="3035" href="STLC.html#3035" class="Function">_</a> <a id="3037" class="Symbol">=</a> <a id="3039" href="Text.Parser.Monad.html#2343" class="Function">ParserM.monadZero</a>
  <a id="3059" href="STLC.html#3059" class="Function">_</a> <a id="3061" class="Symbol">=</a> <a id="3063" href="Text.Parser.Monad.html#2725" class="Function">ParserM.monadPlus</a>
  <a id="3083" href="STLC.html#3083" class="Function">_</a> <a id="3085" class="Symbol">=</a> <a id="3087" href="Text.Parser.Monad.html#4105" class="Function">ParserM.monad</a>

<a id="P"></a><a id="3102" href="STLC.html#3102" class="Function">P</a> <a id="3104" class="Symbol">=</a> <a id="3106" href="Text.Parser.Monad.html#3705" class="Function">ParserM.param</a> <a id="3120" href="STLC.html#2416" class="Function">Token</a> <a id="3126" class="Symbol">(</a><a id="3127" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="3131" href="STLC.html#2416" class="Function">Token</a><a id="3136" class="Symbol">)</a> <a id="3138" class="Symbol">λ</a> <a id="3140" class="Keyword">where</a> <a id="3146" class="Symbol">(</a><a id="3147" href="STLC.html#3147" class="Bound">p</a> <a id="3149" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3151" class="Symbol">_)</a> <a id="3154" class="Symbol">_</a> <a id="3156" class="Symbol">→</a> <a id="3158" href="Text.Parser.Monad.html#775" class="InductiveConstructor">Value</a> <a id="3164" class="Symbol">(_</a> <a id="3167" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3169" href="STLC.html#3147" class="Bound">p</a> <a id="3171" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3173" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="3175" class="Symbol">)</a>

<a id="theTok"></a><a id="3178" href="STLC.html#3178" class="Function">theTok</a> <a id="3185" class="Symbol">:</a> <a id="3187" href="STLC.html#922" class="Datatype">Tok</a> <a id="3191" class="Symbol">→</a> <a id="3193" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="3196" href="Text.Parser.Types.html#1195" class="Record">Parser</a> <a id="3203" href="STLC.html#3102" class="Function">P</a> <a id="3205" href="STLC.html#2416" class="Function">Token</a> <a id="3211" href="Relation.Unary.html#3359" class="Function">]</a>
<a id="3213" href="STLC.html#3178" class="Function">theTok</a> <a id="3220" href="STLC.html#3220" class="Bound">t</a> <a id="3222" class="Symbol">=</a> <a id="3224" href="Text.Parser.Combinators.html#1763" class="Function">maybeTok</a> <a id="3233" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="3235" class="Symbol">λ</a> <a id="3237" class="Keyword">where</a>
  <a id="3245" href="STLC.html#3245" class="Bound">tok</a><a id="3248" class="Symbol">@(</a><a id="3250" href="STLC.html#3250" class="Bound">p</a> <a id="3252" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3254" href="STLC.html#3254" class="Bound">t&#39;</a><a id="3256" class="Symbol">)</a> <a id="3258" class="Symbol">→</a> <a id="3260" href="Function.Base.html#3544" class="Function Operator">case</a> <a id="3265" href="STLC.html#1001" class="Function">eqTok</a> <a id="3271" href="STLC.html#3220" class="Bound">t</a> <a id="3273" href="STLC.html#3254" class="Bound">t&#39;</a> <a id="3276" href="Function.Base.html#3544" class="Function Operator">of</a> <a id="3279" class="Symbol">λ</a> <a id="3281" class="Keyword">where</a>
    <a id="3291" class="Symbol">(</a><a id="3292" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a> <a id="3296" href="STLC.html#3296" class="Bound">eq</a><a id="3298" class="Symbol">)</a> <a id="3300" class="Symbol">→</a> <a id="3302" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a> <a id="3307" href="STLC.html#3245" class="Bound">tok</a>
    <a id="3315" class="Symbol">(</a><a id="3316" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="3319" href="STLC.html#3319" class="Bound">¬eq</a><a id="3322" class="Symbol">)</a> <a id="3324" class="Symbol">→</a> <a id="3326" href="Data.Maybe.Base.html#872" class="InductiveConstructor">nothing</a>

<a id="parens"></a><a id="3335" href="STLC.html#3335" class="Function">parens</a> <a id="3342" class="Symbol">:</a> <a id="3344" class="Symbol">∀</a> <a id="3346" class="Symbol">{</a><a id="3347" href="STLC.html#3347" class="Bound">A</a><a id="3348" class="Symbol">}</a> <a id="3350" class="Symbol">→</a> <a id="3352" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="3355" href="Induction.Nat.Strong.html#197" class="Record Operator">□</a> <a id="3357" href="Text.Parser.Types.html#1195" class="Record">Parser</a> <a id="3364" href="STLC.html#3102" class="Function">P</a> <a id="3366" href="STLC.html#3347" class="Bound">A</a> <a id="3368" href="STLC.html#627" class="Function Operator">⟶</a> <a id="3370" href="Text.Parser.Types.html#1195" class="Record">Parser</a> <a id="3377" href="STLC.html#3102" class="Function">P</a> <a id="3379" href="STLC.html#3347" class="Bound">A</a> <a id="3381" href="Relation.Unary.html#3359" class="Function">]</a>
<a id="3383" href="STLC.html#3335" class="Function">parens</a> <a id="3390" href="STLC.html#3390" class="Bound">□p</a> <a id="3393" class="Symbol">=</a> <a id="3395" href="STLC.html#3178" class="Function">theTok</a> <a id="3402" href="STLC.html#964" class="InductiveConstructor">LPAR</a> <a id="3407" href="Text.Parser.Combinators.html#3753" class="Function Operator">&amp;&gt;</a> <a id="3410" href="STLC.html#3390" class="Bound">□p</a> <a id="3413" href="Text.Parser.Combinators.html#3668" class="Function Operator">&lt;&amp;</a> <a id="3416" href="Text.Parser.Combinators.html#2070" class="Function">box</a> <a id="3420" class="Symbol">(</a><a id="3421" href="STLC.html#3178" class="Function">theTok</a> <a id="3428" href="STLC.html#969" class="InductiveConstructor">RPAR</a><a id="3432" class="Symbol">)</a>

<a id="name"></a><a id="3435" href="STLC.html#3435" class="Function">name</a> <a id="3440" class="Symbol">:</a> <a id="3442" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="3445" href="Text.Parser.Types.html#1195" class="Record">Parser</a> <a id="3452" href="STLC.html#3102" class="Function">P</a> <a id="3454" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="3461" href="Relation.Unary.html#3359" class="Function">]</a>
<a id="3463" href="STLC.html#3435" class="Function">name</a> <a id="3468" class="Symbol">=</a> <a id="3470" href="Text.Parser.Combinators.html#1763" class="Function">maybeTok</a> <a id="3479" class="Symbol">λ</a> <a id="3481" class="Keyword">where</a> <a id="3487" class="Symbol">(</a><a id="3488" href="STLC.html#3488" class="Bound">p</a> <a id="3490" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3492" href="STLC.html#982" class="InductiveConstructor">ID</a> <a id="3495" href="STLC.html#3495" class="Bound">str</a><a id="3498" class="Symbol">)</a> <a id="3500" class="Symbol">→</a> <a id="3502" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a> <a id="3507" href="STLC.html#3495" class="Bound">str</a><a id="3510" class="Symbol">;</a> <a id="3512" class="CatchallClause Symbol">_</a> <a id="3514" class="Symbol">→</a> <a id="3516" href="Data.Maybe.Base.html#872" class="InductiveConstructor">nothing</a>

<a id="type"></a><a id="3525" href="STLC.html#3525" class="Function">type</a> <a id="3530" class="Symbol">:</a> <a id="3532" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="3535" href="Text.Parser.Types.html#1195" class="Record">Parser</a> <a id="3542" href="STLC.html#3102" class="Function">P</a> <a id="3544" href="STLC.html#2878" class="Datatype">Type</a> <a id="3549" href="Relation.Unary.html#3359" class="Function">]</a>
<a id="3551" href="STLC.html#3525" class="Function">type</a> <a id="3556" class="Symbol">=</a> <a id="3558" href="Induction.Nat.Strong.html#1160" class="Function">fix</a> <a id="3562" class="Symbol">_</a> <a id="3564" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="3566" class="Symbol">λ</a> <a id="3568" href="STLC.html#3568" class="Bound">rec</a> <a id="3572" class="Symbol">→</a>
  <a id="3576" class="Keyword">let</a> <a id="3580" href="STLC.html#3580" class="Bound">varlike</a> <a id="3588" href="STLC.html#3588" class="Bound">str</a> <a id="3592" class="Symbol">=</a> <a id="3594" href="Function.Base.html#3544" class="Function Operator">case</a> <a id="3599" href="Data.String.Base.html#1413" class="Primitive">String.toList</a> <a id="3613" href="STLC.html#3588" class="Bound">str</a> <a id="3617" href="Function.Base.html#3544" class="Function Operator">of</a> <a id="3620" class="Symbol">λ</a> <a id="3622" class="Keyword">where</a>
        <a id="3636" class="Symbol">(</a><a id="3637" class="String">&#39;`&#39;</a> <a id="3641" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3643" href="STLC.html#3643" class="Bound">nm</a><a id="3645" class="Symbol">)</a> <a id="3647" class="Symbol">→</a> <a id="3649" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a> <a id="3654" class="Symbol">(</a><a id="3655" href="Data.String.Base.html#1446" class="Primitive">String.fromList</a> <a id="3671" href="STLC.html#3643" class="Bound">nm</a><a id="3673" class="Symbol">)</a>
        <a id="3683" class="CatchallClause Symbol">_</a> <a id="3685" class="Symbol">→</a> <a id="3687" href="Data.Maybe.Base.html#872" class="InductiveConstructor">nothing</a>
  <a id="3697" class="Keyword">in</a> <a id="3700" href="Text.Parser.Combinators.html#7591" class="Function">chainr1</a> <a id="3708" class="Symbol">(</a><a id="3709" href="STLC.html#2897" class="InductiveConstructor">`κ</a> <a id="3712" href="Text.Parser.Combinators.html#2377" class="Function Operator">&lt;$&gt;</a> <a id="3716" href="Text.Parser.Combinators.html#1474" class="Function">guardM</a> <a id="3723" href="STLC.html#3580" class="Bound">varlike</a> <a id="3731" href="STLC.html#3435" class="Function">name</a> <a id="3736" href="Text.Parser.Combinators.html#2204" class="Function Operator">&lt;|&gt;</a> <a id="3740" href="STLC.html#3335" class="Function">parens</a> <a id="3747" href="STLC.html#3568" class="Bound">rec</a><a id="3750" class="Symbol">)</a>
             <a id="3765" class="Symbol">(</a><a id="3766" href="Text.Parser.Combinators.html#2070" class="Function">box</a> <a id="3770" class="Symbol">(</a><a id="3771" href="STLC.html#2920" class="InductiveConstructor Operator">_`→_</a> <a id="3776" href="Text.Parser.Combinators.html#2505" class="Function Operator">&lt;$</a> <a id="3779" href="STLC.html#3178" class="Function">theTok</a> <a id="3786" href="STLC.html#944" class="InductiveConstructor">ARR</a><a id="3789" class="Symbol">))</a>

<a id="3793" class="Keyword">open</a> <a id="3798" class="Keyword">import</a> <a id="3805" href="Base.html" class="Module">Base</a> <a id="3810" class="Keyword">using</a> <a id="3816" class="Symbol">(</a><a id="3817" href="Base.html#1200" class="Datatype">Singleton</a><a id="3826" class="Symbol">;</a> <a id="3828" href="Base.html#1238" class="InductiveConstructor Operator">_!</a><a id="3830" class="Symbol">)</a>

<a id="parse"></a><a id="3833" href="STLC.html#3833" class="Function">parse</a> <a id="3839" class="Symbol">:</a> <a id="3841" class="Symbol">∀</a> <a id="3843" class="Symbol">{</a><a id="3844" href="STLC.html#3844" class="Bound">A</a><a id="3845" class="Symbol">}</a> <a id="3847" class="Symbol">→</a> <a id="3849" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="3852" href="Text.Parser.Types.html#1195" class="Record">Parser</a> <a id="3859" href="STLC.html#3102" class="Function">P</a> <a id="3861" href="STLC.html#3844" class="Bound">A</a> <a id="3863" href="Relation.Unary.html#3359" class="Function">]</a> <a id="3865" class="Symbol">→</a> <a id="3867" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="3874" class="Symbol">→</a> <a id="3876" class="PrimitiveType">Set</a>
<a id="3880" href="STLC.html#3833" class="Function">parse</a> <a id="3886" href="STLC.html#3886" class="Bound">p</a> <a id="3888" href="STLC.html#3888" class="Bound">str</a> <a id="3892" class="Symbol">=</a> <a id="3894" class="Keyword">let</a> <a id="3898" href="STLC.html#3898" class="Bound">input</a> <a id="3904" class="Symbol">=</a> <a id="3906" href="Data.Vec.Base.html#7501" class="Function">Vec.fromList</a> <a id="3919" class="Symbol">(</a><a id="3920" href="Text.Lexer.html#1204" class="Function">tokenize</a> <a id="3929" href="STLC.html#3888" class="Bound">str</a><a id="3932" class="Symbol">)</a> <a id="3934" class="Keyword">in</a>
  <a id="3939" href="Function.Base.html#3544" class="Function Operator">case</a> <a id="3944" href="Text.Parser.Types.html#1300" class="Field">runParser</a> <a id="3954" href="STLC.html#3886" class="Bound">p</a> <a id="3956" href="Data.Nat.Properties.html#3725" class="Function">≤-refl</a> <a id="3963" href="STLC.html#3898" class="Bound">input</a> <a id="3969" class="Symbol">(</a><a id="3970" href="Text.Parser.Position.html#409" class="Function">start</a> <a id="3976" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3978" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="3980" class="Symbol">)</a> <a id="3982" href="Function.Base.html#3544" class="Function Operator">of</a> <a id="3985" class="Symbol">λ</a> <a id="3987" class="Keyword">where</a>
    <a id="3997" class="Symbol">(</a><a id="3998" href="Text.Parser.Monad.html#775" class="InductiveConstructor">Value</a> <a id="4004" class="Symbol">((</a><a id="4006" href="STLC.html#4006" class="Bound">a</a> <a id="4008" href="Text.Parser.Types.html#907" class="InductiveConstructor Operator">^</a> <a id="4010" class="Symbol">_</a> <a id="4012" href="Text.Parser.Types.html#907" class="InductiveConstructor Operator">,</a> <a id="4014" class="Symbol">_)</a> <a id="4017" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4019" class="Symbol">_))</a> <a id="4023" class="Symbol">→</a> <a id="4025" href="Base.html#1200" class="Datatype">Singleton</a> <a id="4035" href="STLC.html#4006" class="Bound">a</a>
    <a id="4041" class="CatchallClause Symbol">_</a> <a id="4043" class="Symbol">→</a> <a id="4045" href="Data.Empty.html#526" class="Datatype">⊥</a>

<a id="4048" href="STLC.html#4048" class="Function">_</a> <a id="4050" class="Symbol">:</a> <a id="4052" href="STLC.html#3833" class="Function">parse</a> <a id="4058" href="STLC.html#3525" class="Function">type</a> <a id="4063" class="String">&quot;`a → (`b → `c) → `b&quot;</a>
<a id="4085" class="Symbol">_</a> <a id="4087" class="Symbol">=</a> <a id="4089" href="STLC.html#2897" class="InductiveConstructor">`κ</a> <a id="4092" class="String">&quot;a&quot;</a> <a id="4096" href="STLC.html#2920" class="InductiveConstructor Operator">`→</a> <a id="4099" class="Symbol">(</a><a id="4100" href="STLC.html#2897" class="InductiveConstructor">`κ</a> <a id="4103" class="String">&quot;b&quot;</a> <a id="4107" href="STLC.html#2920" class="InductiveConstructor Operator">`→</a> <a id="4110" href="STLC.html#2897" class="InductiveConstructor">`κ</a> <a id="4113" class="String">&quot;c&quot;</a><a id="4116" class="Symbol">)</a> <a id="4118" href="STLC.html#2920" class="InductiveConstructor Operator">`→</a> <a id="4121" href="STLC.html#2897" class="InductiveConstructor">`κ</a> <a id="4124" class="String">&quot;b&quot;</a> <a id="4128" href="Base.html#1238" class="InductiveConstructor Operator">!</a>

<a id="4131" class="Keyword">mutual</a>

  <a id="4141" class="Keyword">data</a> <a id="Val"></a><a id="4146" href="STLC.html#4146" class="Datatype">Val</a> <a id="4150" class="Symbol">:</a> <a id="4152" class="PrimitiveType">Set</a> <a id="4156" class="Keyword">where</a>
    <a id="Val.Lam"></a><a id="4166" href="STLC.html#4166" class="InductiveConstructor">Lam</a> <a id="4170" class="Symbol">:</a> <a id="4172" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="4179" class="Symbol">→</a> <a id="4181" href="STLC.html#4146" class="Datatype">Val</a> <a id="4185" class="Symbol">→</a> <a id="4187" href="STLC.html#4146" class="Datatype">Val</a>
    <a id="Val.Emb"></a><a id="4195" href="STLC.html#4195" class="InductiveConstructor">Emb</a> <a id="4199" class="Symbol">:</a> <a id="4201" href="STLC.html#4219" class="Datatype">Neu</a> <a id="4205" class="Symbol">→</a> <a id="4207" href="STLC.html#4146" class="Datatype">Val</a>

  <a id="4214" class="Keyword">data</a> <a id="Neu"></a><a id="4219" href="STLC.html#4219" class="Datatype">Neu</a> <a id="4223" class="Symbol">:</a> <a id="4225" class="PrimitiveType">Set</a> <a id="4229" class="Keyword">where</a>
    <a id="Neu.Var"></a><a id="4239" href="STLC.html#4239" class="InductiveConstructor">Var</a> <a id="4243" class="Symbol">:</a> <a id="4245" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="4252" class="Symbol">→</a> <a id="4254" href="STLC.html#4219" class="Datatype">Neu</a>
    <a id="Neu.Cut"></a><a id="4262" href="STLC.html#4262" class="InductiveConstructor">Cut</a> <a id="4266" class="Symbol">:</a> <a id="4268" href="STLC.html#4146" class="Datatype">Val</a> <a id="4272" class="Symbol">→</a> <a id="4274" href="STLC.html#2878" class="Datatype">Type</a> <a id="4279" class="Symbol">→</a> <a id="4281" href="STLC.html#4219" class="Datatype">Neu</a>
    <a id="Neu.App"></a><a id="4289" href="STLC.html#4289" class="InductiveConstructor">App</a> <a id="4293" class="Symbol">:</a> <a id="4295" href="STLC.html#4219" class="Datatype">Neu</a> <a id="4299" class="Symbol">→</a> <a id="4301" href="STLC.html#4146" class="Datatype">Val</a> <a id="4305" class="Symbol">→</a> <a id="4307" href="STLC.html#4219" class="Datatype">Neu</a>

<a id="4312" class="Keyword">record</a> <a id="Language"></a><a id="4319" href="STLC.html#4319" class="Record">Language</a> <a id="4328" href="STLC.html#4328" class="Bound">n</a> <a id="4330" class="Symbol">:</a> <a id="4332" class="PrimitiveType">Set</a> <a id="4336" class="Keyword">where</a>
  <a id="4344" class="Keyword">field</a> <a id="Language.pVal"></a><a id="4350" href="STLC.html#4350" class="Field">pVal</a> <a id="4355" class="Symbol">:</a> <a id="4357" href="Text.Parser.Types.html#1195" class="Record">Parser</a> <a id="4364" href="STLC.html#3102" class="Function">P</a> <a id="4366" href="STLC.html#4146" class="Datatype">Val</a> <a id="4370" href="STLC.html#4328" class="Bound">n</a>
        <a id="Language.pNeu"></a><a id="4380" href="STLC.html#4380" class="Field">pNeu</a> <a id="4385" class="Symbol">:</a> <a id="4387" href="Text.Parser.Types.html#1195" class="Record">Parser</a> <a id="4394" href="STLC.html#3102" class="Function">P</a> <a id="4396" href="STLC.html#4219" class="Datatype">Neu</a> <a id="4400" href="STLC.html#4328" class="Bound">n</a>
<a id="4402" class="Keyword">open</a> <a id="4407" href="STLC.html#4319" class="Module">Language</a>

<a id="language"></a><a id="4417" href="STLC.html#4417" class="Function">language</a> <a id="4426" class="Symbol">:</a> <a id="4428" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="4431" href="STLC.html#4319" class="Record">Language</a> <a id="4440" href="Relation.Unary.html#3359" class="Function">]</a>
<a id="4442" href="STLC.html#4417" class="Function">language</a> <a id="4451" class="Symbol">=</a> <a id="4453" href="Induction.Nat.Strong.html#1160" class="Function">fix</a> <a id="4457" href="STLC.html#4319" class="Record">Language</a> <a id="4466" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="4468" class="Symbol">λ</a> <a id="4470" href="STLC.html#4470" class="Bound">rec</a> <a id="4474" class="Symbol">→</a>
  <a id="4478" class="Keyword">let</a> <a id="4482" href="STLC.html#4482" class="Bound">□val</a> <a id="4487" class="Symbol">=</a> <a id="4489" href="Induction.Nat.Strong.html#341" class="Function">INS.map</a> <a id="4497" href="STLC.html#4350" class="Field">pVal</a> <a id="4502" href="STLC.html#4470" class="Bound">rec</a>
      <a id="4512" href="STLC.html#4512" class="Bound">□neu</a> <a id="4517" class="Symbol">=</a> <a id="4519" href="Induction.Nat.Strong.html#341" class="Function">INS.map</a> <a id="4527" href="STLC.html#4380" class="Field">pNeu</a> <a id="4532" href="STLC.html#4470" class="Bound">rec</a>
      <a id="4542" href="STLC.html#4542" class="Bound">var</a>  <a id="4547" class="Symbol">=</a> <a id="4549" href="STLC.html#4239" class="InductiveConstructor">Var</a> <a id="4553" href="Text.Parser.Combinators.html#2377" class="Function Operator">&lt;$&gt;</a> <a id="4557" href="Text.Parser.Combinators.html#1651" class="Function">guard</a> <a id="4563" class="Symbol">(</a><a id="4564" href="Data.List.Base.html#4163" class="Function">List.all</a> <a id="4573" href="Data.Char.Base.html#728" class="Primitive">isAlpha</a> <a id="4581" href="Function.Base.html#3193" class="Function Operator">∘′</a> <a id="4584" href="Data.String.Base.html#1413" class="Primitive">String.toList</a><a id="4597" class="Symbol">)</a> <a id="4599" href="STLC.html#3435" class="Function">name</a>
      <a id="4610" href="STLC.html#4610" class="Bound">cut</a>  <a id="4615" class="Symbol">=</a> <a id="4617" class="Symbol">(λ</a> <a id="4620" class="Keyword">where</a> <a id="4626" class="Symbol">((</a><a id="4628" href="STLC.html#4628" class="Bound">v</a> <a id="4630" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4632" class="Symbol">_)</a> <a id="4635" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4637" href="STLC.html#4637" class="Bound">σ</a><a id="4638" class="Symbol">)</a> <a id="4640" class="Symbol">→</a> <a id="4642" href="STLC.html#4262" class="InductiveConstructor">Cut</a> <a id="4646" href="STLC.html#4628" class="Bound">v</a> <a id="4648" href="STLC.html#4637" class="Bound">σ</a><a id="4649" class="Symbol">)</a>
             <a id="4664" href="Text.Parser.Combinators.html#2377" class="Function Operator">&lt;$&gt;</a> <a id="4668" class="Symbol">(</a><a id="4669" href="STLC.html#3178" class="Function">theTok</a> <a id="4676" href="STLC.html#964" class="InductiveConstructor">LPAR</a>
              <a id="4695" href="Text.Parser.Combinators.html#3753" class="Function Operator">&amp;&gt;</a> <a id="4698" href="STLC.html#4482" class="Bound">□val</a> <a id="4703" href="Text.Parser.Combinators.html#3580" class="Function Operator">&lt;&amp;&gt;</a> <a id="4707" href="Text.Parser.Combinators.html#2070" class="Function">box</a> <a id="4711" class="Symbol">(</a><a id="4712" href="STLC.html#3178" class="Function">theTok</a> <a id="4719" href="STLC.html#952" class="InductiveConstructor">COL</a><a id="4722" class="Symbol">)</a> <a id="4724" href="Text.Parser.Combinators.html#3580" class="Function Operator">&lt;&amp;&gt;</a> <a id="4728" href="Text.Parser.Combinators.html#2070" class="Function">box</a> <a id="4732" class="Symbol">(</a><a id="4733" href="Text.Parser.Monad.html#4207" class="Function">commit</a> <a id="4740" href="STLC.html#3525" class="Function">type</a><a id="4744" class="Symbol">)</a>
              <a id="4760" href="Text.Parser.Combinators.html#3668" class="Function Operator">&lt;&amp;</a> <a id="4763" href="Text.Parser.Combinators.html#2070" class="Function">box</a> <a id="4767" class="Symbol">(</a><a id="4768" href="STLC.html#3178" class="Function">theTok</a> <a id="4775" href="STLC.html#969" class="InductiveConstructor">RPAR</a><a id="4779" class="Symbol">))</a>
      <a id="4788" href="STLC.html#4788" class="Bound">app</a>  <a id="4793" class="Symbol">=</a> <a id="4795" href="Function.Base.html#1193" class="Function">flip</a> <a id="4800" href="STLC.html#4289" class="InductiveConstructor">App</a> <a id="4804" href="Text.Parser.Combinators.html#2377" class="Function Operator">&lt;$&gt;</a> <a id="4808" class="Symbol">((</a><a id="4810" href="STLC.html#4195" class="InductiveConstructor">Emb</a> <a id="4814" href="Text.Parser.Combinators.html#2377" class="Function Operator">&lt;$&gt;</a> <a id="4818" href="STLC.html#4542" class="Bound">var</a><a id="4821" class="Symbol">)</a> <a id="4823" href="Text.Parser.Combinators.html#2204" class="Function Operator">&lt;|&gt;</a> <a id="4827" href="STLC.html#3335" class="Function">parens</a> <a id="4834" href="STLC.html#4482" class="Bound">□val</a><a id="4838" class="Symbol">)</a>
      <a id="4846" href="STLC.html#4846" class="Bound">neu</a>  <a id="4851" class="Symbol">=</a> <a id="4853" href="Text.Parser.Combinators.html#7084" class="Function">iterate</a> <a id="4861" class="Symbol">(</a><a id="4862" href="STLC.html#4542" class="Bound">var</a> <a id="4866" href="Text.Parser.Combinators.html#2204" class="Function Operator">&lt;|&gt;</a> <a id="4870" href="STLC.html#4610" class="Bound">cut</a> <a id="4874" href="Text.Parser.Combinators.html#2204" class="Function Operator">&lt;|&gt;</a> <a id="4878" href="STLC.html#3335" class="Function">parens</a> <a id="4885" href="STLC.html#4512" class="Bound">□neu</a><a id="4889" class="Symbol">)</a> <a id="4891" class="Symbol">(</a><a id="4892" href="Text.Parser.Combinators.html#2070" class="Function">box</a> <a id="4896" href="STLC.html#4788" class="Bound">app</a><a id="4899" class="Symbol">)</a>
      <a id="4907" href="STLC.html#4907" class="Bound">lam</a>  <a id="4912" class="Symbol">=</a> <a id="4914" href="Data.Product.html#3103" class="Function">uncurry</a> <a id="4922" href="STLC.html#4166" class="InductiveConstructor">Lam</a>
             <a id="4939" href="Text.Parser.Combinators.html#2377" class="Function Operator">&lt;$&gt;</a> <a id="4943" class="Symbol">((</a><a id="4945" href="STLC.html#3178" class="Function">theTok</a> <a id="4952" href="STLC.html#940" class="InductiveConstructor">LAM</a> <a id="4956" href="Text.Parser.Combinators.html#3753" class="Function Operator">&amp;&gt;</a> <a id="4959" href="Text.Parser.Combinators.html#2070" class="Function">box</a> <a id="4963" href="STLC.html#3435" class="Function">name</a><a id="4967" class="Symbol">)</a>
             <a id="4982" href="Text.Parser.Combinators.html#3580" class="Function Operator">&lt;&amp;&gt;</a> <a id="4986" href="Text.Parser.Combinators.html#2070" class="Function">box</a> <a id="4990" class="Symbol">(</a><a id="4991" href="STLC.html#3178" class="Function">theTok</a> <a id="4998" href="STLC.html#948" class="InductiveConstructor">DOT</a> <a id="5002" href="Text.Parser.Combinators.html#3753" class="Function Operator">&amp;&gt;</a> <a id="5005" href="Induction.Nat.Strong.html#341" class="Function">INS.map</a> <a id="5013" href="Text.Parser.Monad.html#4207" class="Function">commit</a> <a id="5020" href="STLC.html#4482" class="Bound">□val</a><a id="5024" class="Symbol">))</a>
      <a id="5033" href="STLC.html#5033" class="Bound">val</a> <a id="5037" class="Symbol">=</a> <a id="5039" href="STLC.html#4907" class="Bound">lam</a> <a id="5043" href="Text.Parser.Combinators.html#2204" class="Function Operator">&lt;|&gt;</a> <a id="5047" href="STLC.html#4195" class="InductiveConstructor">Emb</a> <a id="5051" href="Text.Parser.Combinators.html#2377" class="Function Operator">&lt;$&gt;</a> <a id="5055" href="STLC.html#4846" class="Bound">neu</a>

  <a id="5062" class="Keyword">in</a> <a id="5065" class="Keyword">record</a> <a id="5072" class="Symbol">{</a> <a id="5074" href="STLC.html#4350" class="Field">pVal</a> <a id="5079" class="Symbol">=</a> <a id="5081" href="STLC.html#5033" class="Bound">val</a> <a id="5085" href="Text.Parser.Combinators.html#2204" class="Function Operator">&lt;|&gt;</a> <a id="5089" href="STLC.html#3335" class="Function">parens</a> <a id="5096" href="STLC.html#4482" class="Bound">□val</a>
            <a id="5113" class="Symbol">;</a> <a id="5115" href="STLC.html#4380" class="Field">pNeu</a> <a id="5120" class="Symbol">=</a> <a id="5122" href="STLC.html#4846" class="Bound">neu</a> <a id="5126" href="Text.Parser.Combinators.html#2204" class="Function Operator">&lt;|&gt;</a> <a id="5130" href="STLC.html#3335" class="Function">parens</a> <a id="5137" href="STLC.html#4512" class="Bound">□neu</a>
            <a id="5154" class="Symbol">}</a>

<a id="val"></a><a id="5157" href="STLC.html#5157" class="Function">val</a> <a id="5161" class="Symbol">:</a> <a id="5163" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="5166" href="Text.Parser.Types.html#1195" class="Record">Parser</a> <a id="5173" href="STLC.html#3102" class="Function">P</a> <a id="5175" href="STLC.html#4146" class="Datatype">Val</a> <a id="5179" href="Relation.Unary.html#3359" class="Function">]</a>
<a id="5181" href="STLC.html#5157" class="Function">val</a> <a id="5185" class="Symbol">=</a> <a id="5187" href="STLC.html#4350" class="Field">pVal</a> <a id="5192" href="STLC.html#4417" class="Function">language</a>

<a id="5202" class="Comment">-- tests</a>

<a id="5212" href="STLC.html#5212" class="Function">_</a> <a id="5214" class="Symbol">:</a> <a id="5216" href="STLC.html#3833" class="Function">parse</a> <a id="5222" href="STLC.html#5157" class="Function">val</a> <a id="5226" class="String">&quot;λx.x&quot;</a>
<a id="5233" class="Symbol">_</a> <a id="5235" class="Symbol">=</a> <a id="5237" href="STLC.html#4166" class="InductiveConstructor">Lam</a> <a id="5241" class="String">&quot;x&quot;</a> <a id="5245" class="Symbol">(</a><a id="5246" href="STLC.html#4195" class="InductiveConstructor">Emb</a> <a id="5250" class="Symbol">(</a><a id="5251" href="STLC.html#4239" class="InductiveConstructor">Var</a> <a id="5255" class="String">&quot;x&quot;</a><a id="5258" class="Symbol">))</a> <a id="5261" href="Base.html#1238" class="InductiveConstructor Operator">!</a>

<a id="5264" href="STLC.html#5264" class="Function">_</a> <a id="5266" class="Symbol">:</a> <a id="5268" href="STLC.html#3833" class="Function">parse</a> <a id="5274" href="STLC.html#5157" class="Function">val</a> <a id="5278" class="String">&quot;λx.(λy.x y)&quot;</a>
<a id="5292" class="Symbol">_</a> <a id="5294" class="Symbol">=</a> <a id="5296" href="STLC.html#4166" class="InductiveConstructor">Lam</a> <a id="5300" class="String">&quot;x&quot;</a> <a id="5304" class="Symbol">(</a><a id="5305" href="STLC.html#4166" class="InductiveConstructor">Lam</a> <a id="5309" class="String">&quot;y&quot;</a> <a id="5313" class="Symbol">(</a><a id="5314" href="STLC.html#4195" class="InductiveConstructor">Emb</a> <a id="5318" class="Symbol">(</a><a id="5319" href="STLC.html#4289" class="InductiveConstructor">App</a> <a id="5323" class="Symbol">(</a><a id="5324" href="STLC.html#4239" class="InductiveConstructor">Var</a> <a id="5328" class="String">&quot;x&quot;</a><a id="5331" class="Symbol">)</a> <a id="5333" class="Symbol">(</a><a id="5334" href="STLC.html#4195" class="InductiveConstructor">Emb</a> <a id="5338" class="Symbol">(</a><a id="5339" href="STLC.html#4239" class="InductiveConstructor">Var</a> <a id="5343" class="String">&quot;y&quot;</a><a id="5346" class="Symbol">)))))</a> <a id="5352" href="Base.html#1238" class="InductiveConstructor Operator">!</a>

<a id="5355" href="STLC.html#5355" class="Function">_</a> <a id="5357" class="Symbol">:</a> <a id="5359" href="STLC.html#3833" class="Function">parse</a> <a id="5365" href="STLC.html#5157" class="Function">val</a> <a id="5369" class="String">&quot;(λx.(λx.x : `a → `a) x)&quot;</a>
<a id="5395" class="Symbol">_</a> <a id="5397" class="Symbol">=</a> <a id="5399" href="STLC.html#4166" class="InductiveConstructor">Lam</a> <a id="5403" class="String">&quot;x&quot;</a>
      <a id="5413" class="Symbol">(</a><a id="5414" href="STLC.html#4195" class="InductiveConstructor">Emb</a> <a id="5418" class="Symbol">(</a><a id="5419" href="STLC.html#4289" class="InductiveConstructor">App</a> <a id="5423" class="Symbol">(</a><a id="5424" href="STLC.html#4262" class="InductiveConstructor">Cut</a> <a id="5428" class="Symbol">(</a><a id="5429" href="STLC.html#4166" class="InductiveConstructor">Lam</a> <a id="5433" class="String">&quot;x&quot;</a> <a id="5437" class="Symbol">(</a><a id="5438" href="STLC.html#4195" class="InductiveConstructor">Emb</a> <a id="5442" class="Symbol">(</a><a id="5443" href="STLC.html#4239" class="InductiveConstructor">Var</a> <a id="5447" class="String">&quot;x&quot;</a><a id="5450" class="Symbol">)))</a> <a id="5454" class="Symbol">(</a><a id="5455" href="STLC.html#2897" class="InductiveConstructor">`κ</a> <a id="5458" class="String">&quot;a&quot;</a> <a id="5462" href="STLC.html#2920" class="InductiveConstructor Operator">`→</a> <a id="5465" href="STLC.html#2897" class="InductiveConstructor">`κ</a> <a id="5468" class="String">&quot;a&quot;</a><a id="5471" class="Symbol">))</a>
                <a id="5490" class="Symbol">(</a><a id="5491" href="STLC.html#4195" class="InductiveConstructor">Emb</a> <a id="5495" class="Symbol">(</a><a id="5496" href="STLC.html#4239" class="InductiveConstructor">Var</a> <a id="5500" class="String">&quot;x&quot;</a><a id="5503" class="Symbol">))))</a> <a id="5508" href="Base.html#1238" class="InductiveConstructor Operator">!</a>

<a id="5511" href="STLC.html#5511" class="Function">_</a> <a id="5513" class="Symbol">:</a> <a id="5515" href="STLC.html#3833" class="Function">parse</a> <a id="5521" href="STLC.html#5157" class="Function">val</a> <a id="5525" class="String">&quot;λg.λf.λa.g a (f a)&quot;</a>
<a id="5546" class="Symbol">_</a> <a id="5548" class="Symbol">=</a> <a id="5550" href="STLC.html#4166" class="InductiveConstructor">Lam</a> <a id="5554" class="String">&quot;g&quot;</a> <a id="5558" class="Symbol">(</a><a id="5559" href="STLC.html#4166" class="InductiveConstructor">Lam</a> <a id="5563" class="String">&quot;f&quot;</a> <a id="5567" class="Symbol">(</a><a id="5568" href="STLC.html#4166" class="InductiveConstructor">Lam</a> <a id="5572" class="String">&quot;a&quot;</a>
     <a id="5581" class="Symbol">(</a><a id="5582" href="STLC.html#4195" class="InductiveConstructor">Emb</a> <a id="5586" class="Symbol">(</a><a id="5587" href="STLC.html#4289" class="InductiveConstructor">App</a> <a id="5591" class="Symbol">(</a><a id="5592" href="STLC.html#4289" class="InductiveConstructor">App</a> <a id="5596" class="Symbol">(</a><a id="5597" href="STLC.html#4239" class="InductiveConstructor">Var</a> <a id="5601" class="String">&quot;g&quot;</a><a id="5604" class="Symbol">)</a> <a id="5606" class="Symbol">(</a><a id="5607" href="STLC.html#4195" class="InductiveConstructor">Emb</a> <a id="5611" class="Symbol">(</a><a id="5612" href="STLC.html#4239" class="InductiveConstructor">Var</a> <a id="5616" class="String">&quot;a&quot;</a><a id="5619" class="Symbol">)))</a>
               <a id="5638" class="Symbol">(</a><a id="5639" href="STLC.html#4195" class="InductiveConstructor">Emb</a> <a id="5643" class="Symbol">(</a><a id="5644" href="STLC.html#4289" class="InductiveConstructor">App</a> <a id="5648" class="Symbol">(</a><a id="5649" href="STLC.html#4239" class="InductiveConstructor">Var</a> <a id="5653" class="String">&quot;f&quot;</a><a id="5656" class="Symbol">)</a> <a id="5658" class="Symbol">(</a><a id="5659" href="STLC.html#4195" class="InductiveConstructor">Emb</a> <a id="5663" class="Symbol">(</a><a id="5664" href="STLC.html#4239" class="InductiveConstructor">Var</a> <a id="5668" class="String">&quot;a&quot;</a><a id="5671" class="Symbol">))))))))</a> <a id="5680" href="Base.html#1238" class="InductiveConstructor Operator">!</a>

<a id="5683" href="STLC.html#5683" class="Function">_</a> <a id="5685" class="Symbol">:</a> <a id="5687" href="STLC.html#3833" class="Function">parse</a> <a id="5693" href="STLC.html#5157" class="Function">val</a> <a id="5697" class="String">&quot;(λg.λf.λa.(g a) (f a))&quot;</a>
<a id="5722" class="Symbol">_</a> <a id="5724" class="Symbol">=</a> <a id="5726" href="STLC.html#4166" class="InductiveConstructor">Lam</a> <a id="5730" class="String">&quot;g&quot;</a> <a id="5734" class="Symbol">(</a><a id="5735" href="STLC.html#4166" class="InductiveConstructor">Lam</a> <a id="5739" class="String">&quot;f&quot;</a> <a id="5743" class="Symbol">(</a><a id="5744" href="STLC.html#4166" class="InductiveConstructor">Lam</a> <a id="5748" class="String">&quot;a&quot;</a>
     <a id="5757" class="Symbol">(</a><a id="5758" href="STLC.html#4195" class="InductiveConstructor">Emb</a> <a id="5762" class="Symbol">(</a><a id="5763" href="STLC.html#4289" class="InductiveConstructor">App</a> <a id="5767" class="Symbol">(</a><a id="5768" href="STLC.html#4289" class="InductiveConstructor">App</a> <a id="5772" class="Symbol">(</a><a id="5773" href="STLC.html#4239" class="InductiveConstructor">Var</a> <a id="5777" class="String">&quot;g&quot;</a><a id="5780" class="Symbol">)</a> <a id="5782" class="Symbol">(</a><a id="5783" href="STLC.html#4195" class="InductiveConstructor">Emb</a> <a id="5787" class="Symbol">(</a><a id="5788" href="STLC.html#4239" class="InductiveConstructor">Var</a> <a id="5792" class="String">&quot;a&quot;</a><a id="5795" class="Symbol">)))</a>
               <a id="5814" class="Symbol">(</a><a id="5815" href="STLC.html#4195" class="InductiveConstructor">Emb</a> <a id="5819" class="Symbol">(</a><a id="5820" href="STLC.html#4289" class="InductiveConstructor">App</a> <a id="5824" class="Symbol">(</a><a id="5825" href="STLC.html#4239" class="InductiveConstructor">Var</a> <a id="5829" class="String">&quot;f&quot;</a><a id="5832" class="Symbol">)</a> <a id="5834" class="Symbol">(</a><a id="5835" href="STLC.html#4195" class="InductiveConstructor">Emb</a> <a id="5839" class="Symbol">(</a><a id="5840" href="STLC.html#4239" class="InductiveConstructor">Var</a> <a id="5844" class="String">&quot;a&quot;</a><a id="5847" class="Symbol">))))))))</a> <a id="5856" href="Base.html#1238" class="InductiveConstructor Operator">!</a>

<a id="5859" href="STLC.html#5859" class="Function">_</a> <a id="5861" class="Symbol">:</a> <a id="5863" href="STLC.html#3833" class="Function">parse</a> <a id="5869" href="STLC.html#5157" class="Function">val</a> <a id="5873" class="String">&quot;(λg.(λf.(λa.(((g) ((a)))) ((f) (a))))))&quot;</a>
<a id="5915" class="Symbol">_</a> <a id="5917" class="Symbol">=</a> <a id="5919" href="STLC.html#4166" class="InductiveConstructor">Lam</a> <a id="5923" class="String">&quot;g&quot;</a> <a id="5927" class="Symbol">(</a><a id="5928" href="STLC.html#4166" class="InductiveConstructor">Lam</a> <a id="5932" class="String">&quot;f&quot;</a> <a id="5936" class="Symbol">(</a><a id="5937" href="STLC.html#4166" class="InductiveConstructor">Lam</a> <a id="5941" class="String">&quot;a&quot;</a>
     <a id="5950" class="Symbol">(</a><a id="5951" href="STLC.html#4195" class="InductiveConstructor">Emb</a> <a id="5955" class="Symbol">(</a><a id="5956" href="STLC.html#4289" class="InductiveConstructor">App</a> <a id="5960" class="Symbol">(</a><a id="5961" href="STLC.html#4289" class="InductiveConstructor">App</a> <a id="5965" class="Symbol">(</a><a id="5966" href="STLC.html#4239" class="InductiveConstructor">Var</a> <a id="5970" class="String">&quot;g&quot;</a><a id="5973" class="Symbol">)</a> <a id="5975" class="Symbol">(</a><a id="5976" href="STLC.html#4195" class="InductiveConstructor">Emb</a> <a id="5980" class="Symbol">(</a><a id="5981" href="STLC.html#4239" class="InductiveConstructor">Var</a> <a id="5985" class="String">&quot;a&quot;</a><a id="5988" class="Symbol">)))</a>
               <a id="6007" class="Symbol">(</a><a id="6008" href="STLC.html#4195" class="InductiveConstructor">Emb</a> <a id="6012" class="Symbol">(</a><a id="6013" href="STLC.html#4289" class="InductiveConstructor">App</a> <a id="6017" class="Symbol">(</a><a id="6018" href="STLC.html#4239" class="InductiveConstructor">Var</a> <a id="6022" class="String">&quot;f&quot;</a><a id="6025" class="Symbol">)</a> <a id="6027" class="Symbol">(</a><a id="6028" href="STLC.html#4195" class="InductiveConstructor">Emb</a> <a id="6032" class="Symbol">(</a><a id="6033" href="STLC.html#4239" class="InductiveConstructor">Var</a> <a id="6037" class="String">&quot;a&quot;</a><a id="6040" class="Symbol">))))))))</a> <a id="6049" href="Base.html#1238" class="InductiveConstructor Operator">!</a>
</pre></body></html>